{"version":3,"sources":["AudioMgr.js"],"names":["cc","Class","extends","Component","properties","bgmVolume","sfxVolume","bgmAudioID","init","resetLocalAudio","game","on","EVENT_HIDE","audioEngine","pauseAll","EVENT_SHOW","resumeAll","t","sys","localStorage","getItem","parseFloat","setBGMVolume","setSFXVolume","getUrl","url","raw","v","setItem","resume","pause","setVolume","playBGM","audioUrl","stop","play","playSFX","audioId"],"mappings":"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","file":"AudioMgr.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\mgr","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        bgmVolume:1.0,\r\n        sfxVolume:1.0,\r\n        bgmAudioID:-1,\r\n    },\r\n\r\n    init:function(){\r\n        this.resetLocalAudio();\r\n        cc.game.on(cc.game.EVENT_HIDE,function(){\r\n            cc.audioEngine.pauseAll();\r\n        })\r\n        cc.game.on(cc.game.EVENT_SHOW,function(){\r\n            cc.audioEngine.resumeAll();\r\n        })\r\n    },\r\n    resetLocalAudio:function(){\r\n         var t = cc.sys.localStorage.getItem(\"bgmVolume\");\r\n        if(t != null){\r\n            this.bgmVolume = parseFloat(t);    \r\n        }else{\r\n\t\t\tthis.bgmVolume = parseFloat(0.2); \r\n            this.setBGMVolume(0.3) \r\n\t\t}\r\n        var t = cc.sys.localStorage.getItem(\"sfxVolume\");\r\n        if(t != null){\r\n            this.sfxVolume = parseFloat(t);    \r\n        }else{\r\n\t\t\tthis.sfxVolume = parseFloat(0.9); \r\n            this.setSFXVolume(1) \r\n            \r\n\t\t}\r\n    },\r\n    getUrl:function(url){\r\n        return cc.url.raw(\"resources/sounds/\" + url);\r\n    },\r\n\r\n    setSFXVolume:function(v){\r\n        if(this.sfxVolume != v){\r\n            cc.sys.localStorage.setItem(\"sfxVolume\",v);\r\n            this.sfxVolume = v;\r\n        }\r\n    },\r\n\r\n    setBGMVolume:function(v){\r\n        if(this.bgmAudioID >= 0){\r\n            if(v > 0){\r\n                cc.audioEngine.resume(this.bgmAudioID);\r\n            }else{\r\n                cc.audioEngine.pause(this.bgmAudioID);\r\n            }\r\n        }\r\n        if(this.bgmVolume != v){\r\n            cc.sys.localStorage.setItem(\"bgmVolume\",v);\r\n            this.bgmVolume = v;\r\n            cc.audioEngine.setVolume(this.bgmAudioID,v);\r\n        }\r\n    },\r\n\r\n    pauseAll:function(){\r\n        cc.audioEngine.pauseAll();\r\n    },\r\n    \r\n    resumeAll:function(){\r\n        cc.audioEngine.resumeAll();\r\n    },\r\n\r\n    playBGM(url){\r\n        var audioUrl = this.getUrl(url);\r\n        if(this.bgmAudioID >= 0){\r\n            cc.audioEngine.stop(this.bgmAudioID);\r\n        }\r\n        if(this.bgmVolume > 0){\r\n            this.bgmAudioID = cc.audioEngine.play(audioUrl,true,this.bgmVolume);\r\n        }\r\n    },\r\n\r\n    playSFX(url){\r\n        var audioUrl = this.getUrl(url);\r\n        if(this.sfxVolume > 0){\r\n            var audioId = cc.audioEngine.play(audioUrl,false,this.sfxVolume);\r\n        }\r\n    },\r\n\r\n});\r\n"]}