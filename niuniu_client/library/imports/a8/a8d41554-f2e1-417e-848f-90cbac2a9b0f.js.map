{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\scripts\\logic/assets\\scripts\\logic\\Game.js"],"names":["cc","Class","extends","Component","properties","_roominfo","_roomstate","_roombeishu","_roomjushu","_tips","_tipLabel","_tipslast","_lastTime","_shengyinBtn","_homeBtn","onLoad","roombg","node","getChildByName","gameview","getComponent","Label","string","Grobal","roomNum","card","find","undefined","args","_choiceBtn","vv","uitools","addClickEvent","initHandlers","UpdateRoomInfo","initPreLoad","loader","loadRes","err","prefab","onTestCallBack","onGuizeBtnClick","LOCALHOST","hallSDK","goRule","onTishiClick","ShowLayer","onShengyinBtnClick","onHomeBtnClick","ShowAlert","director","getScene","goHall","window","location","href","onWanfaBtnClick","goWanfa","SetClick","ShowControlList","self","layer","instantiate","addChild","ShowTips","msg","active","height","status","gameNetMgr","getIsOpen","netRoot","on","detail","ext","JSON","parse","decodeURIComponent","difen","update","dt","str","replace","Date","now"],"mappings":"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","file":"Game.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\logic","sourcesContent":["cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        _roominfo:null,\n        _roomstate:null,\n        _roombeishu:null,\n        _roomjushu:null,\n        _tips:null,\n        _tipLabel:null,\n        _tipslast:null,\n        _lastTime:0,\n        _shengyinBtn:null,\n        _homeBtn:null,\n    },\n\n    onLoad: function () {\n\n        var roombg = this.node.getChildByName(\"room_bg\");\n        var gameview = this.node.getChildByName(\"gameview\");\n        this._roominfo = roombg.getChildByName(\"roominfo\").getComponent(cc.Label);  \n        this._roomstate = roombg.getChildByName(\"roomstate\");                       \n        this._roomjushu = roombg.getChildByName(\"roomjushu\").getComponent(cc.Label);\n        this._tips = gameview.getChildByName(\"tips\");\n        this._tipLabel = this._tips.getChildByName(\"label\").getComponent(cc.Label);\n        this._roominfo.string = \"桌号：\"+ Grobal.roomNum;          //桌号\n        var card = cc.find(\"Canvas/gameview/fangka/card\");\n        if(card!=null&&card!=undefined){\n            card.getComponent(cc.Label).string=cc.args[\"currency\"]+\"张\";     //房卡\n        }\n        this._choiceBtn = gameview.getChildByName(\"choiceBtn\");\n        if(this._choiceBtn!=null){\n            cc.vv.uitools.addClickEvent(this._choiceBtn,this.node,\"GameLogic\",\"ShowControlList\");\n        }\n\n        this.initHandlers();\n        this.UpdateRoomInfo();\n        this.initPreLoad();\n    },\n\n    initPreLoad:function(){\n        cc.loader.loadRes(\"prefabs/AlertUI\",function(err,prefab){});\n    },\n\n    onTestCallBack:function(){\n    },\n\n    onGuizeBtnClick:function(){\n        if(!cc.LOCALHOST){\n            cc.vv.hallSDK.goRule();\n        }\n    },\n    onTishiClick:function(){\n        cc.vv.uitools.ShowLayer(\"TipRule\",this.node);\n    },\n    onShengyinBtnClick:function(){\n        cc.vv.uitools.ShowLayer(\"SettingUI2\",this.node);\n    },\n    onHomeBtnClick:function(){\n        cc.vv.uitools.ShowAlert(cc.director.getScene(),\"确认返回主页\",function(){\n            if(!cc.LOCALHOST){\n                cc.vv.hallSDK.goHall();\n            }else{\n                window.location.href = \"/\";\n            }\n        },true);\n        \n    },\n    onWanfaBtnClick:function(){\n\n        if(!cc.LOCALHOST){\n            cc.vv.hallSDK.goWanfa();\n        }\n    },\n\n\n    SetClick:function(){\n        cc.vv.uitools.ShowLayer(\"SettingUI2\",this.node);\n    },\n\n    ShowControlList:function(){\n        var self = this;\n        cc.loader.loadRes(\"prefabs/ControllUI\",function(err,prefab){\n            if(self.node.getChildByName(\"ControllUI\") == null){\n                 var layer = cc.instantiate(prefab);\n                 self.node.addChild(layer);\n            }\n        });\n             \n    },\n\n    ShowTips:function(msg){\n        var self = this;\n        if(msg == null){\n            self._tips.active = false\n        }else{\n            self._tips.active = true\n            self._tipLabel.string = msg;\n            self._tips.height = this._tips.getChildByName(\"label\").height+20;\n            if((Grobal.status==\"standup\"||Grobal.status==\"ready\")&&msg!=\"网络不稳定,正在重新连接\"){\n                if(cc.vv.gameNetMgr.getIsOpen()){\n                    self._tipLabel.string = \"请等待下一局\";\n                }\n            }\n        }\n    },\n\n    initHandlers:function(){\n        var self = this\n        cc.vv.netRoot.on('show_tips_message',function(msg){\n            self.ShowTips(msg.detail);\n        },this);\n    },\n\n\n    UpdateRoomInfo:function(){\n         if(cc.args['ext']!=undefined && cc.args['ext']!=null){\n            var ext = JSON.parse(decodeURIComponent(cc.args['ext']));\n            var difen = this._roomstate.getChildByName(\"difen\").getComponent(cc.Label);\n            difen.string = \"底分：\"+ext.difen+\"分\";\n         }\n    },\n    update:function(dt){\n        if(this._tips.active==true){\n            var str = this._tipLabel.string.replace(this._tipslast,\"\");\n            if(Date.now() - this._lastTime > 1000){\n                if(this._tipslast==null||this._tipslast==\"...\"){\n                    this._tipslast=\".\";\n                }else{\n                    this._tipslast=this._tipslast+\".\";\n                }\n                this._tipLabel.string = str + this._tipslast;\n                this._lastTime = Date.now();\n            }\n        }\n    },\n});\n"]}