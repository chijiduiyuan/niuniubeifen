{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\scripts\\comp/assets\\scripts\\comp\\Voice.js"],"names":["cc","Class","extends","Component","properties","_emoji","_chatBubble","_voicemsg","_adj","_voicetime","_voicenum","_lastChatTime","onLoad","init","node","getChildByName","active","voiceMsg","show","Date","now","chat","content","getComponent","Label","string","width","emoji","Animation","play","update","dt","stop","i","children","length"],"mappings":"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","file":"Voice.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\comp","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        _emoji:null,\r\n        _chatBubble:null,\r\n        _voicemsg:null,\r\n        _adj:null,\r\n\t\t_voicetime:0,\r\n\t\t_voicenum:3,\r\n        _lastChatTime:-1,\r\n    },\r\n\r\n    onLoad: function () {\r\n        this.init();\r\n    },\r\n\r\n    init:function(){\r\n        this._chatBubble = this.node.getChildByName(\"ChatBubble\");     \r\n        this._emoji = this.node.getChildByName(\"emoji\"); \r\n        this._voicemsg = this.node.getChildByName(\"voicemsg\");  \r\n        if(this._voicemsg!=null){\r\n\t\t\tthis._adj = this._voicemsg.getChildByName(\"adj\");\r\n            this._voicemsg.active = false;\r\n\t\t}\r\n        this._chatBubble.active = false;\r\n        this._emoji.active = false;\r\n    },\r\n    voiceMsg:function(show){\r\n        if(this._voicemsg){\r\n            this._voicemsg.active = show;\r\n\t\t\tif(show===true){\r\n\t\t\t\tthis._voicenum=3;\r\n\t\t\t\tthis._voicetime=Date.now();\t\r\n\t\t\t}else{\r\n\t\t\t\tthis._voicetime=0;\t\r\n\t\t\t}\r\n        }\r\n    },\r\n    chat:function(content){\r\n        if(this._chatBubble == null || content == null){\r\n            return;\r\n        }\r\n        this._emoji.active = false;\r\n        this._chatBubble.active = true;\r\n        this._chatBubble.getChildByName(\"message\").getComponent(cc.Label).string = content;\r\n        this._chatBubble.getChildByName(\"chatbubble_bg\").width =  this._chatBubble.getChildByName(\"message\").width+35;\r\n        this._lastChatTime = 3;\r\n    },\r\n    \r\n    emoji:function(emoji){\r\n        if(this._emoji == null || emoji == null){\r\n            return;\r\n        }\r\n        this._chatBubble.active = false;\r\n        this._emoji.active = true;\r\n        this._emoji.getComponent(cc.Animation).play(emoji);\r\n        this._lastChatTime = 3;\r\n    },\r\n    update: function (dt) {\r\n        if(this._lastChatTime > 0){\r\n            this._lastChatTime -= dt;\r\n            if(this._lastChatTime < 0){\r\n                this._chatBubble.active = false;\r\n                this._emoji.active = false;\r\n                this._emoji.getComponent(cc.Animation).stop();\r\n            }\r\n        }\r\n        if(this._voicemsg!=null){\r\n\t\t\tif(this._voicemsg.active===true){\r\n\t\t\t\tif((Date.now()-this._voicetime>700 && this._voicetime>0)){\r\n\t\t\t\t\tthis._voicetime=Date.now();\r\n\t\t\t\t\tfor(var i = 0; i < this._adj.children.length; ++i){\r\n\t\t\t\t\t\tthis._adj.children[i].active = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis._adj.children[this._voicenum-1].active = true; \r\n\t\t\t\t\tthis._voicenum=this._voicenum-1;\r\n\t\t\t\t\tif(this._voicenum<=0){\r\n\t\t\t\t\t\tthis._voicenum=3;\t\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n    },\r\n});\r\n"]}